# OAuth ะฐะฒัะพัะธะทะฐัะธั ะธ ัะตะณะธัััะฐัะธั (Google & VK)

## โ ะะตะฐะปะธะทะพะฒะฐะฝะพ

ะะพะปะฝะพัััั ัะตะฐะปะธะทะพะฒะฐะฝะฐ ะฐะฒัะพัะธะทะฐัะธั ะธ ัะตะณะธัััะฐัะธั ัะตัะตะท Google ะธ VK ั ะฟะพะดะดะตัะถะบะพะน:
- ะัะพะด ัะตัะตะท OAuth
- ะะตะณะธัััะฐัะธั ัะตัะตะท OAuth
- ะะฑัะฐะฑะพัะบะฐ ัะพะบะตะฝะพะฒ ะธะท fragment (#)
- ะะฑัะฐะฑะพัะบะฐ ะพัะธะฑะพะบ OAuth
- ะัะฐะฒะธะปัะฝัะน flow ะดะปั ะบะฐะถะดะพะณะพ ะฟัะพะฒะฐะนะดะตัะฐ

## ๐ง ะะฐะบ ััะพ ัะฐะฑะพัะฐะตั

### 1. Flow ะฐะฒัะพัะธะทะฐัะธะธ (Sign In)

```
โโโโโโโโโโโโโโโ
โ   ะะพะปัะทะพะฒะฐัะตะปั   โ
โ  ะฝะฐะถะธะผะฐะตั "ะะพะนัะธ โ
โ   ัะตัะตะท Google"  โ
โโโโโโโโโโฌโโโโโโโโโ
         โ
         โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ ะะตะดะธัะตะบั ะฝะฐ Google OAuth             โ
โ (ั ะฟะฐัะฐะผะตััะพะผ state='sign-in')       โ
โโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
         โ
         โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ Google ะฒะพะทะฒัะฐัะฐะตั id_token           โ
โ ะฒ fragment (#id_token=...)           โ
โโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
         โ
         โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ AuthPage ะพะฑัะฐะฑะฐััะฒะฐะตั ัะพะบะตะฝ          โ
โ authService.signInWithGoogle()       โ
โโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
         โ
         โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ ะฃัะฟะตัะฝัะน ะฒัะพะด โ ะะตะดะธัะตะบั ะฝะฐ /        โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

### 2. Flow ัะตะณะธัััะฐัะธะธ (Sign Up)

```
โโโโโโโโโโโโโโโโโโโโโโโ
โ    ะะพะปัะทะพะฒะฐัะตะปั     โ
โ  ะฝะฐะถะธะผะฐะตั           โ
โ "ะะฐัะตะณะธัััะธัะพะฒะฐัััั โ
โ   ัะตัะตะท Google"     โ
โโโโโโโโโโโฌโโโโโโโโโโโโ
          โ
          โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ ะะตะดะธัะตะบั ะฝะฐ Google OAuth               โ
โ (ั ะฟะฐัะฐะผะตััะพะผ state='sign-up')         โ
โโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
          โ
          โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ Google ะฒะพะทะฒัะฐัะฐะตั id_token             โ
โ ะฒ fragment (#id_token=...)             โ
โโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
          โ
          โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ AuthPage ะทะฐะฟัะฐัะธะฒะฐะตั ะปะพะณะธะฝ ะธ email     โ
โ (ัะตัะตะท prompt - ะฒัะตะผะตะฝะฝะพะต ัะตัะตะฝะธะต)     โ
โโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
          โ
          โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ authService.signUpWithGoogle()         โ
โ { login, email, googleIdToken }        โ
โโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
          โ
          โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ API ะพัะฟัะฐะฒะปัะตั ะบะพะด ะฝะฐ email            โ
โ ะะพะปัะทะพะฒะฐัะตะปั ะฟะตัะตัะพะดะธั ะฝะฐ /auth/sign-upโ
โโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
          โ
          โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ ะะฒะพะดะธั ะบะพะด ะฟะพะดัะฒะตัะถะดะตะฝะธั               โ
โ authService.verify()                   โ
โโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
          โ
          โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ ะฃัะฟะตัะฝะฐั ัะตะณะธัััะฐัะธั โ ะัะพะด ะฒ ัะธััะตะผั โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

## ๐ ะะตะฐะปะธะทะพะฒะฐะฝะฝัะต ััะฝะบัะธะธ

### 1. OAuth ะบะพะฝัะธะณััะฐัะธั (`src/ui/config/oauth.ts`)

```typescript
// ะคัะฝะบัะธะธ ะฟัะธะฝะธะผะฐัั ัะตะถะธะผ ะดะปั ัะฐะทะปะธัะตะฝะธั ะฒัะพะดะฐ ะธ ัะตะณะธัััะฐัะธะธ
buildGoogleOAuthUrl(mode: 'sign-in' | 'sign-up' = 'sign-in'): string
buildVkOAuthUrl(mode: 'sign-in' | 'sign-up' = 'sign-in'): string
```

**ะะฐะถะฝะพ:**
- Google ะฒะพะทะฒัะฐัะฐะตั ัะพะบะตะฝ ะฒ fragment: `#id_token=...`
- VK ะฒะพะทะฒัะฐัะฐะตั ัะพะบะตะฝ ะฒ fragment: `#access_token=...`
- ะะฐัะฐะผะตัั `state` ะธัะฟะพะปัะทัะตััั ะดะปั ะพะฟัะตะดะตะปะตะฝะธั ัะตะถะธะผะฐ (ะฒัะพะด/ัะตะณะธัััะฐัะธั)

### 2. AuthService ะผะตัะพะดั

**ะะปั ะฒัะพะดะฐ:**
```typescript
signInWithGoogle({ googleIdToken }): Promise<SignInResponse>
signInWithVk({ vkAccessToken }): Promise<SignInResponse>
```

**ะะปั ัะตะณะธัััะฐัะธะธ:**
```typescript
signUpWithGoogle({ login, email, googleIdToken }): Promise<SignUpResponse>
signUpWithVk({ login, email, vkAccessToken }): Promise<SignUpResponse>
```

### 3. ะะฑัะฐะฑะพัะบะฐ OAuth ะฒ AuthPage

```typescript
// ะงะธัะฐะตั ัะพะบะตะฝั ะธะท fragment (#)
const hash = location.hash.substring(1);
const hashParams = new URLSearchParams(hash);
const googleIdToken = hashParams.get('id_token');
const vkAccessToken = hashParams.get('access_token');

// ะะฟัะตะดะตะปัะตั ัะตะถะธะผ ะธะท state
const oauthState = hashParams.get('state') || 'sign-in';
const isSignUp = oauthState.includes('sign-up');
```

### 4. ะะฑัะฐะฑะพัะบะฐ ะพัะธะฑะพะบ

ะะตะฐะปะธะทะพะฒะฐะฝะฐ ััะฝะบัะธั `handleOAuthError()` ะดะปั ะพะฑัะฐะฑะพัะบะธ ะฒัะตั ะพัะธะฑะพะบ OAuth:

```typescript
- INVALID_LOGIN - "ะะตะฒะตัะฝัะน ัะพัะผะฐั ะปะพะณะธะฝะฐ"
- INVALID_EMAIL - "ะะตะฒะตัะฝัะน ัะพัะผะฐั email"
- LOGIN_ALREADY_TAKEN - "ะญัะพั ะปะพะณะธะฝ ัะถะต ะทะฐะฝัั"
- EMAIL_ALREADY_TAKEN - "ะญัะพั email ัะถะต ะธัะฟะพะปัะทัะตััั"
- OAuth errors - ะัะธะฑะบะธ ะธะท ัะฐะผะธั ะฟัะพะฒะฐะนะดะตัะพะฒ
```

## ๐จ UI ะบะพะผะฟะพะฝะตะฝัั

### ะะฝะพะฟะบะธ OAuth

**ะะปั ะฒัะพะดะฐ:**
```tsx
<button onClick={() => window.location.assign(buildGoogleOAuthUrl('sign-in'))}>
    ะะพะนัะธ ัะตัะตะท Google
</button>
<button onClick={() => window.location.assign(buildVkOAuthUrl('sign-in'))}>
    ะะพะนัะธ ัะตัะตะท VK
</button>
```

**ะะปั ัะตะณะธัััะฐัะธะธ:**
```tsx
<button onClick={() => window.location.assign(buildGoogleOAuthUrl('sign-up'))}>
    ะะฐัะตะณะธัััะธัะพะฒะฐัััั ัะตัะตะท Google
</button>
<button onClick={() => window.location.assign(buildVkOAuthUrl('sign-up'))}>
    ะะฐัะตะณะธัััะธัะพะฒะฐัััั ัะตัะตะท VK
</button>
```

### ะฃัะปะพะฒะธั ะพัะพะฑัะฐะถะตะฝะธั

ะะฝะพะฟะบะธ OAuth ะฟะพะบะฐะทัะฒะฐัััั:
- ะะฐ ัััะฐะฝะธัะต ะฒัะพะดะฐ (`mode === 'sign-in'`)
- ะะฐ ัััะฐะฝะธัะต ัะตะณะธัััะฐัะธะธ (`mode === 'sign-up'`)
- ะะ ะฟะพะบะฐะทัะฒะฐัััั ะฟะพัะปะต ะฟะพะปััะตะฝะธั ะบะพะดะฐ ะฟะพะดัะฒะตัะถะดะตะฝะธั (`!signUpHash`)

## โ๏ธ ะะฐัััะพะนะบะฐ

### ะขัะตะฑัะตะผัะต ะฟะตัะตะผะตะฝะฝัะต ะฒ `src/ui/config/oauth.ts`:

```typescript
export const GOOGLE_CLIENT_ID = 'YOUR_GOOGLE_CLIENT_ID';
export const VK_APP_ID = 'YOUR_VK_APP_ID';
```

### Google OAuth Setup

1. ะกะพะทะดะฐะนัะต ะฟัะพะตะบั ะฒ [Google Cloud Console](https://console.cloud.google.com)
2. ะะบะปััะธัะต Google+ API
3. ะกะพะทะดะฐะนัะต OAuth 2.0 Client ID
4. ะะพะฑะฐะฒััะต redirect URI: `http://localhost:5173/auth` (ะดะปั ัะฐะทัะฐะฑะพัะบะธ)
5. ะกะบะพะฟะธััะนัะต Client ID

**ะะฐัััะพะนะบะธ:**
- Application type: Web application
- Authorized JavaScript origins: `http://localhost:5173`
- Authorized redirect URIs: `http://localhost:5173/auth`

### VK OAuth Setup

1. ะกะพะทะดะฐะนัะต ะฟัะธะปะพะถะตะฝะธะต ะฒ [VK Developers](https://vk.com/apps?act=manage)
2. ะะพะปััะธัะต App ID
3. ะะฐัััะพะนัะต OAuth settings

**ะะฐัััะพะนะบะธ:**
- Authorized redirect URI: `http://localhost:5173/auth`
- API version: 5.199

## ๐ ะะตะทะพะฟะฐัะฝะพััั

### ะะตะฐะปะธะทะพะฒะฐะฝะฝัะต ะผะตัั ะฑะตะทะพะฟะฐัะฝะพััะธ:

1. **Nonce ะดะปั Google** - ะทะฐัะธัะฐ ะพั CSRF ะฐัะฐะบ
2. **State parameter** - ะฒะฐะปะธะดะฐัะธั ะพัะฒะตัะฐ + ัะตะถะธะผ ัะฐะฑะพัั
3. **Fragment ะดะปั ัะพะบะตะฝะพะฒ** - ัะพะบะตะฝั ะฝะต ะฟะพะฟะฐะดะฐัั ะฝะฐ ัะตัะฒะตั
4. **ะัะธััะบะฐ URL** - ัะพะบะตะฝั ัะดะฐะปััััั ะธะท URL ะฟะพัะปะต ะพะฑัะฐะฑะพัะบะธ
5. **ะะฑัะฐะฑะพัะบะฐ ะพัะธะฑะพะบ** - ะบะพััะตะบัะฝะฐั ะพะฑัะฐะฑะพัะบะฐ ะพัะธะฑะพะบ OAuth

### ะงัะพ ะฟัะพะฒะตััะตััั:

```typescript
// ะัะพะฒะตัะบะฐ ะฝะฐะปะธัะธั ะพัะธะฑะพะบ ะพั OAuth ะฟัะพะฒะฐะนะดะตัะฐ
const oauthError = hashParams.get('error');
const oauthErrorDescription = hashParams.get('error_description');

// ะัะพะฒะตัะบะฐ ะบะพะดะพะฒ ะพัะฒะตัะฐ ะพั API
if (data?.code === ResponseCode.SUCCESSFUL) {
    // Success
} else {
    // Handle specific error codes
}
```

## ๐ ะัะฟะพะปัะทะพะฒะฐะฝะธะต

### ะะปั ัะฐะทัะฐะฑะพัะบะธ:

1. ะฃััะฐะฝะพะฒะธัะต GOOGLE_CLIENT_ID ะธ VK_APP_ID ะฒ `oauth.ts`
2. ะะฐะฟัััะธัะต ะฟัะธะปะพะถะตะฝะธะต: `npm run dev`
3. ะะตัะตะนะดะธัะต ะฝะฐ `/auth`
4. ะะฐะถะผะธัะต "ะะพะนัะธ ัะตัะตะท Google" ะธะปะธ "ะะพะนัะธ ัะตัะตะท VK"

### ะะปั ะฟัะพะดะฐะบัะตะฝะฐ:

1. ะะฐัะตะณะธัััะธััะนัะต production redirect URI ะฒ ะบะพะฝัะพะปัั Google ะธ VK
2. ะะฑะฝะพะฒะธัะต `OAUTH_REDIRECT_URI` ะดะปั production ะดะพะผะตะฝะฐ
3. ะัะฟะพะปัะทัะนัะต environment variables ะดะปั Client ID:

```typescript
export const GOOGLE_CLIENT_ID = import.meta.env.VITE_GOOGLE_CLIENT_ID || '';
export const VK_APP_ID = import.meta.env.VITE_VK_APP_ID || '';
```

## ๐ API ัะฝะดะฟะพะธะฝัั

### ะัะพะด:
- `POST /auth/google` - ะฒัะพะด ัะตัะตะท Google
- `POST /auth/vk` - ะฒัะพะด ัะตัะตะท VK

**Request:**
```typescript
{ googleIdToken: string } | { vkAccessToken: string }
```

**Response:**
```typescript
{
  code: 0,
  profile: Profile,
  profileToken: { token: string }
}
```

### ะะตะณะธัััะฐัะธั:
- `POST /auth/google` - ัะตะณะธัััะฐัะธั ัะตัะตะท Google (ัะพั ะถะต ัะฝะดะฟะพะธะฝั)
- `POST /auth/vk` - ัะตะณะธัััะฐัะธั ัะตัะตะท VK (ัะพั ะถะต ัะฝะดะฟะพะธะฝั)

**Request:**
```typescript
{ 
  login: string,
  email: string,
  googleIdToken: string 
} | {
  login: string,
  email: string,
  vkAccessToken: string
}
```

**Response:**
```typescript
{
  code: 0,
  hash: string,
  codeTimestampExpires: number
}
```

## โ๏ธ ะะทะฒะตััะฝัะต ะพะณัะฐะฝะธัะตะฝะธั

### 1. ะัะฟะพะปัะทะพะฒะฐะฝะธะต prompt() ะดะปั ะฒะฒะพะดะฐ ะดะฐะฝะฝัั

**ะขะตะบััะฐั ัะตะฐะปะธะทะฐัะธั:**
```typescript
const login = prompt('ะะฒะตะดะธัะต ะปะพะณะธะฝ ะดะปั ัะตะณะธัััะฐัะธะธ:');
const email = prompt('ะะฒะตะดะธัะต email:');
```

**ะัะพะฑะปะตะผะฐ:** ะะต ะปัััะธะน UX, ะฑะปะพะบะธััะตั ะธะฝัะตััะตะนั

**TODO:** ะกะพะทะดะฐัั ะผะพะดะฐะปัะฝะพะต ะพะบะฝะพ ะดะปั ะฒะฒะพะดะฐ ะปะพะณะธะฝะฐ ะธ email ะฟัะธ ัะตะณะธัััะฐัะธะธ ัะตัะตะท OAuth

### 2. ะััััััะฒะธะต loading ัะพััะพัะฝะธั

ะัะธ ัะตะดะธัะตะบัะต ะฝะฐ OAuth ะฟัะพะฒะฐะนะดะตัะฐ ะฝะตั ะธะฝะดะธะบะฐัะธะธ ะทะฐะณััะทะบะธ

**TODO:** ะะพะฑะฐะฒะธัั loading ัะพััะพัะฝะธะต ะฟะตัะตะด ัะตะดะธัะตะบัะพะผ

### 3. ะะฑัะฐะฑะพัะบะฐ ัะปััะฐั "ัะถะต ะทะฐัะตะณะธัััะธัะพะฒะฐะฝ"

ะัะปะธ ะฟะพะปัะทะพะฒะฐัะตะปั ะฟััะฐะตััั ะทะฐัะตะณะธัััะธัะพะฒะฐัััั ัะตัะตะท OAuth, ะฝะพ ะฐะบะบะฐัะฝั ัะถะต ัััะตััะฒัะตั, ะฝัะถะฝะพ ะฟัะตะดะปะพะถะธัั ะฒัะพะด

**TODO:** ะะพะฑะฐะฒะธัั ะฐะฒัะพะผะฐัะธัะตัะบะธะน ะฟะตัะตะบะปััะตะฝะธะต ะฝะฐ ะฒัะพะด, ะตัะปะธ ะฐะบะบะฐัะฝั ัััะตััะฒัะตั

## ๐ฏ ะฃะปัััะตะฝะธั (TODO)

### ะััะพะบะธะน ะฟัะธะพัะธัะตั:

- [ ] ะะฐะผะตะฝะธัั prompt() ะฝะฐ ะผะพะดะฐะปัะฝะพะต ะพะบะฝะพ ะดะปั ะฒะฒะพะดะฐ ะปะพะณะธะฝะฐ/email
- [ ] ะะพะฑะฐะฒะธัั loading ะธะฝะดะธะบะฐัะพั ะฟัะธ ัะตะดะธัะตะบัะต ะฝะฐ OAuth
- [ ] ะะตะฐะปะธะทะพะฒะฐัั ะฐะฒัะพะผะฐัะธัะตัะบะพะต ะธะทะฒะปะตัะตะฝะธะต email ะธะท OAuth ะฟัะพัะธะปั

### ะกัะตะดะฝะธะน ะฟัะธะพัะธัะตั:

- [ ] ะะพะฑะฐะฒะธัั ะฒะพะทะผะพะถะฝะพััั ะฟัะธะฒัะทะบะธ OAuth ะฐะบะบะฐัะฝัะพะฒ ะบ ัััะตััะฒัััะตะผั ะฟัะพัะธะปั
- [ ] ะะตะฐะปะธะทะพะฒะฐัั ะพัะฒัะทะบั OAuth ะฐะบะบะฐัะฝัะพะฒ
- [ ] ะะพะฑะฐะฒะธัั ะธะฝะดะธะบะฐัะธั ะฟัะธะฒัะทะฐะฝะฝัั OAuth ะฐะบะบะฐัะฝัะพะฒ ะฒ ะฝะฐัััะพะนะบะฐั

### ะะธะทะบะธะน ะฟัะธะพัะธัะตั:

- [ ] ะะพะดะดะตัะถะบะฐ ะดะพะฟะพะปะฝะธัะตะปัะฝัั OAuth ะฟัะพะฒะฐะนะดะตัะพะฒ (Telegram, Yandex)
- [ ] ะะฐะฟะพะผะธะฝะฐะฝะธะต ะฟะพัะปะตะดะฝะตะณะพ ะธัะฟะพะปัะทะพะฒะฐะฝะฝะพะณะพ ะผะตัะพะดะฐ ะฒัะพะดะฐ
- [ ] One-click sign in ะดะปั ะฟะพะฒัะพัะฝัั ะฒัะพะดะพะฒ

## ๐ ะขะตััะธัะพะฒะฐะฝะธะต

### ะกัะตะฝะฐัะธะธ ะดะปั ัะตััะธัะพะฒะฐะฝะธั:

**ะัะพะด ัะตัะตะท Google:**
1. โ ะฃัะฟะตัะฝัะน ะฒัะพะด ัััะตััะฒัััะตะณะพ ะฟะพะปัะทะพะฒะฐัะตะปั
2. โ ะัะธะฑะบะฐ ะฟัะธ ะฝะตัััะตััะฒัััะตะผ ะฐะบะบะฐัะฝัะต
3. โ ะัะผะตะฝะฐ OAuth (ะฟะพะปัะทะพะฒะฐัะตะปั ะฝะฐะถะฐะป "ะัะผะตะฝะฐ" ะฝะฐ ัััะฐะฝะธัะต Google)
4. โ ะะฑัะฐะฑะพัะบะฐ ะพัะธะฑะพะบ ัะตัะธ

**ะะตะณะธัััะฐัะธั ัะตัะตะท Google:**
1. โ ะฃัะฟะตัะฝะฐั ัะตะณะธัััะฐัะธั ะฝะพะฒะพะณะพ ะฟะพะปัะทะพะฒะฐัะตะปั
2. โ ะัะธะฑะบะฐ "ะปะพะณะธะฝ ัะถะต ะทะฐะฝัั"
3. โ ะัะธะฑะบะฐ "email ัะถะต ะธัะฟะพะปัะทัะตััั"
4. โ ะะพะดัะฒะตัะถะดะตะฝะธะต email ะบะพะดะพะผ

**ะัะพะด ัะตัะตะท VK:**
1. โ ะฃัะฟะตัะฝัะน ะฒัะพะด ัััะตััะฒัััะตะณะพ ะฟะพะปัะทะพะฒะฐัะตะปั
2. โ ะัะธะฑะบะฐ ะฟัะธ ะฝะตัััะตััะฒัััะตะผ ะฐะบะบะฐัะฝัะต
3. โ ะัะผะตะฝะฐ OAuth
4. โ ะะฑัะฐะฑะพัะบะฐ ะพัะธะฑะพะบ ัะตัะธ

**ะะตะณะธัััะฐัะธั ัะตัะตะท VK:**
1. โ ะฃัะฟะตัะฝะฐั ัะตะณะธัััะฐัะธั ะฝะพะฒะพะณะพ ะฟะพะปัะทะพะฒะฐัะตะปั
2. โ ะัะธะฑะบะฐ "ะปะพะณะธะฝ ัะถะต ะทะฐะฝัั"
3. โ ะัะธะฑะบะฐ "email ัะถะต ะธัะฟะพะปัะทัะตััั"
4. โ ะะพะดัะฒะตัะถะดะตะฝะธะต email ะบะพะดะพะผ

## ๐ ะัะธะผะตัั

### ะะทะฒะปะตัะตะฝะธะต ัะพะบะตะฝะพะฒ ะธะท URL:

```typescript
// URL ะฟะพัะปะต ัะตะดะธัะตะบัะฐ ะพั Google:
// http://localhost:5173/auth#id_token=eyJ...&state=sign-in

const hash = location.hash.substring(1); // "id_token=eyJ...&state=sign-in"
const params = new URLSearchParams(hash);
const idToken = params.get('id_token'); // "eyJ..."
const state = params.get('state'); // "sign-in"
```

### ะัะฟัะฐะฒะบะฐ ะทะฐะฟัะพัะฐ ะฝะฐ ะฒัะพะด:

```typescript
const data = await authService.signInWithGoogle({ 
    googleIdToken: 'eyJ...' 
});

if (data?.code === ResponseCode.SUCCESSFUL) {
    userStore.login(data.profile, data.profileToken.token);
    setJWT(data.profile.id, data.profileToken.token);
}
```

### ะัะฟัะฐะฒะบะฐ ะทะฐะฟัะพัะฐ ะฝะฐ ัะตะณะธัััะฐัะธั:

```typescript
const data = await authService.signUpWithGoogle({ 
    login: 'myusername',
    email: 'user@example.com',
    googleIdToken: 'eyJ...' 
});

if (data?.code === ResponseCode.SUCCESSFUL) {
    setSignUpHash(data.hash);
    // ะะตัะตัะพะด ะฝะฐ ัะพัะผั ะฒะฒะพะดะฐ ะบะพะดะฐ ะฟะพะดัะฒะตัะถะดะตะฝะธั
}
```

## ๐ ะัะปะฐะดะบะฐ

### ะะบะปััะตะฝะธะต ะปะพะณะพะฒ:

```typescript
// ะ AuthPage.tsx ะดะพะฑะฐะฒััะต:
console.log('OAuth hash:', location.hash);
console.log('OAuth state:', oauthState);
console.log('Google token:', googleIdToken);
console.log('VK token:', vkAccessToken);
```

### ะัะพะฒะตัะบะฐ ัะตะดะธัะตะบัะฐ:

```typescript
// ะัะบัะพะนัะต DevTools โ Network
// ะะฐะนะดะธัะต ัะตะดะธัะตะบั ะฝะฐ Google/VK
// ะัะพะฒะตัััะต ะฟะฐัะฐะผะตััั ะฒ URL
```

### ะัะพะฒะตัะบะฐ API ะพัะฒะตัะพะฒ:

```typescript
// ะ AuthService ะดะพะฑะฐะฒััะต ะปะพะณะธัะพะฒะฐะฝะธะต:
console.log('SignIn response:', response.data);
```

## ๐ ะะทะผะตะฝะตะฝะฝัะต ัะฐะนะปั

- โ `src/ui/config/oauth.ts` - ะดะพะฑะฐะฒะปะตะฝ ะฟะฐัะฐะผะตัั mode
- โ `src/ui/auth/view/AuthPage.tsx` - ะฟะพะปะฝะฐั ะพะฑัะฐะฑะพัะบะฐ OAuth
- โ `src/ui/api/AuthService.ts` - ะผะตัะพะดั ะดะปั OAuth (ัะถะต ะฑัะปะธ)

## โจ ะะตะทัะปััะฐั

ะะพะปะฝะพัััั ััะฝะบัะธะพะฝะฐะปัะฝะฐั OAuth ะฐะฒัะพัะธะทะฐัะธั ะธ ัะตะณะธัััะฐัะธั ัะตัะตะท Google ะธ VK ั:
- โ ะัะฐะฒะธะปัะฝะพะน ะพะฑัะฐะฑะพัะบะพะน ัะพะบะตะฝะพะฒ ะธะท fragment
- โ ะะพะดะดะตัะถะบะพะน ะฒัะพะดะฐ ะธ ัะตะณะธัััะฐัะธะธ
- โ ะะฑัะฐะฑะพัะบะพะน ะฒัะตั ะพัะธะฑะพะบ
- โ ะัะธััะบะพะน URL ะฟะพัะปะต ะพะฑัะฐะฑะพัะบะธ
- โ ะะตะทะพะฟะฐัะฝัะผ flow

